# ğŸ¥— AI Nutritionist - Food Analysis & Nutrition Breakdown

An intelligent AI-powered food analysis system that combines computer vision and generative AI to provide detailed nutritional information, ingredient identification, and health recommendations for food photos.

## ğŸŒŸ Features

- **Specialist Food Recognition**: Uses a specialized Indian-Western food classification model
- **Generalist Image Description**: Employs BLIP for detailed visual description
- **Nutritional Analysis**: Leverages Google Gemini API for comprehensive nutrition estimation
- **Multi-Language Support**: Analyzes both Indian and Western cuisines
- **Health Warnings**: Identifies potential health flags (allergens, high sodium, etc.)
- **Dietary Recommendations**: Provides personalized dietitian advice
- **User-Friendly Interface**: Gradio web UI for easy interaction

## ğŸ“‹ Requirements

### Python Packages
- `torch` - PyTorch for deep learning
- `transformers` - Hugging Face transformers library
- `Pillow` - Image processing
- `langchain` - LLM orchestration
- `langgraph` - Workflow graph execution
- `langchain-google-genai` - Google Generative AI integration
- `google-generativeai` - Google Gemini API
- `gradio` - Web UI framework
- `nest-asyncio` - Async event loop patching
- `protobuf` - Protocol buffers

### Models Used
1. **Specialist Model**: `prithivMLmods/Indian-Western-Food-34` (SigLIP-based)
2. **Generalist Model**: `Salesforce/blip-image-captioning-large`
3. **LLM**: Google Gemini 2.5 Flash

## ğŸš€ Setup Instructions

### 1. Install Dependencies
```bash
pip install -q --ignore-installed \
  langgraph \
  langchain-google-genai \
  google-generativeai \
  protobuf \
  gradio \
  transformers==4.40.2 \
  huggingface_hub==0.23.4 \
  accelerate==0.28.0 \
  safetensors \
  nest-asyncio \
  torch
```

### 2. Configure Google API Key
Get your API key from [Google AI Studio](https://aistudio.google.com/apikey)

In the notebook, update this line:
```python
os.environ["GEMINI_API_KEY"] = "YOUR_API_KEY_HERE"
```

Or set it as an environment variable:
```bash
export GEMINI_API_KEY="YOUR_API_KEY_HERE"
```

## ğŸ’» Usage

### Running the Application

1. **Open the notebook**: `GENAIFinalWithFrontend (2).ipynb`
2. **Run all cells** to initialize the models and start the Gradio server
3. **Access the UI**: Click the public link generated by Gradio (e.g., `https://abc123.gradio.live`)
4. **Upload a food photo** and click "Analyze Food ğŸš€"

### What You Get

The analysis returns:
- ğŸ½ï¸ **Dish Name** with confidence score
- ğŸ“Š **Nutritional Profile**: Calories, protein, carbs, fat
- ğŸ¥— **Ingredients**: Identified ingredients with confidence levels
- ğŸš¦ **Health Analysis**: Warnings about allergens, sodium, sugar, etc.
- ğŸ’¡ **Dietitian's Advice**: Personalized recommendations

## ğŸ—ï¸ Architecture

The system uses a **LangGraph workflow** with three nodes:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Specialist  â”‚ â†’ Identifies specific dish name
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Generalist  â”‚ â†’ Describes visual components
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Gemini Brainâ”‚ â†’ Synthesizes data + generates nutrition
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
    [JSON Output]
```

## ğŸ“ Project Structure

```
Gen-AI-LAB/
â”œâ”€â”€ GENAIFinalWithFrontend (2).ipynb  # Main notebook
â”œâ”€â”€ README.md                          # This file
â””â”€â”€ [Output files generated at runtime]
```

## ğŸ”‘ API Key Security

âš ï¸ **IMPORTANT**: Never commit your API key to version control!

Best practices:
- Use environment variables
- Use `.env` files (add to `.gitignore`)
- Use Google Cloud Secret Manager in production
- Rotate keys regularly

## ğŸ› ï¸ Troubleshooting

### Model Loading Issues
- Ensure you have 4GB+ RAM available
- Install compatible CUDA version if using GPU
- Check internet connection for downloading models

### API Errors
- Verify your Gemini API key is valid
- Check API quota and billing settings
- Ensure you have the latest `google-generativeai` package

### Gradio Server Issues
- Use `nest_asyncio.apply()` to patch event loop conflicts
- Call `gr.close_all()` to kill stuck servers
- Ensure port 7860 is available

## ğŸ“Š Example Output

```json
{
  "dish_name": "Biryani",
  "dish_confidence": 0.95,
  "ingredients": [
    {"name": "Basmati Rice", "confidence": 0.98},
    {"name": "Chicken", "confidence": 0.92}
  ],
  "portion_size": {"size": "Large", "grams_estimate": 400},
  "nutrition_estimate": {
    "calories": 450,
    "protein_g": 25,
    "carbs_g": 55,
    "fat_g": 15
  },
  "health_flags": ["High in calories", "Contains dairy"],
  "diet_advice": ["Pair with salad", "Watch portion size"]
}
```

## ğŸ¯ Supported Cuisines

- âœ… Indian (Biryani, Dosa, Tandoori, Curries, etc.)
- âœ… Western (Pasta, Salads, Steaks, Burgers, etc.)
- âœ… Fusion dishes

## ğŸ“ License

This project uses open-source models and APIs. Ensure compliance with:
- Hugging Face Model Cards
- Google Generative AI Terms of Service

## ğŸ¤ Contributing

Suggestions for improvements:
- Add more regional cuisines
- Implement image preprocessing for better accuracy
- Add meal planning features
- Create mobile app wrapper

## ğŸ“ Support

For issues or questions:
1. Check the troubleshooting section
2. Review error messages in the notebook console
3. Verify API configuration
4. Ensure all dependencies are installed correctly

---

**Built with â¤ï¸ using LangGraph, Gradio, and Google Gemini**
